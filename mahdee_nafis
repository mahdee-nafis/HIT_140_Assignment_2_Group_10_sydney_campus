#Final analytic dataset & safety checks
#We require risk and reward for inferential steps. Coerce to integers and report invalids.

# Step 7: Prepare final analytic dataset
analytic = d.copy()
# Drop rows missing behaviour outcomes
analytic = analytic.dropna(subset=['risk','reward'])
analytic['risk'] = analytic['risk'].astype(int)
analytic['reward'] = analytic['reward'].astype(int)

print("Analytic dataset:", analytic.shape)
print("Risk value counts:\n", analytic['risk'].value_counts(dropna=False))
print("\nReward value counts:\n", analytic['reward'].value_counts(dropna=False))
